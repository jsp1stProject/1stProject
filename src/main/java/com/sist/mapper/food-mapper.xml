<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sist.mapper.food-mapper">
<select id="foodFindData" resultType="FoodVO" parameterType="hashmap"> 
 SELECT fno, name, poster, score, type, address, price, likecount, replycount, num
    FROM (
        SELECT fno, name, poster, score, type, address, price, likecount, replycount, rownum as num
        FROM (
            SELECT /*+ INDEX_ASC(food food_fno_pk) */ fno, name, poster, score, type, address, price, likecount, replycount
            FROM food
            WHERE
            <foreach collection="fdList" item="column" separator=" OR ">
                ${column} LIKE '%' || #{ss} || '%'
            </foreach>
        )
    )
    WHERE num BETWEEN #{start} AND #{end}
    </select>
  <select id="foodFindTotalPage" resultType="int" parameterType="hashmap">
    SELECT CEIL(COUNT(*) / 12.0)
    FROM food
    WHERE 
    <foreach collection="fdList" item="column" separator=" OR ">
        ${column} LIKE '%' || #{ss} || '%'
    </foreach>
  </select>
  <select id="foodFindTotalCount" resultType="int">
    SELECT COUNT(*) 
    FROM food
    WHERE 
    <foreach collection="fdList" item="column" separator=" OR ">
        ${column} LIKE '%' || #{ss} || '%'
    </foreach>
</select>
  <select id="foodDetailData" resultType="FoodVO" parameterType="int">
    SELECT * FROM food
    WHERE fno=#{fno}
  </select>
</mapper>